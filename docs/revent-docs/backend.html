<!DOCTYPE html><html><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if(!e)return localStorage.setItem('theme','light'),d.add('light');if("system"===e){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else d.add(e)}catch(e){}}()</script><link rel="stylesheet" href="https://rsms.me/inter/inter.css"/><title>Untitled<!-- --> - Revent Docs<!-- --></title><style>html{font-family:Inter,sans-serif}@supports(font-variation-settings:normal){html{font-family:'Inter var',sans-serif}}</style><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="description" content="Revent: How did we build this project"/><meta name="og:title" content="Revent: your best Runtime Event"/><meta name="next-head-count" content="8"/><link rel="preload" href="./next/static/css/f6eab16f921f349f.css" as="style"/><link rel="stylesheet" href="./next/static/css/f6eab16f921f349f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="./next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="./next/static/chunks/webpack-ae2ad65ae34e85af.js" defer=""></script><script src="./next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="./next/static/chunks/main-ada0258e433ba222.js" defer=""></script><script src="./next/static/chunks/pages/app-0e38e88d7711f081.js" defer=""></script><script src="./next/static/chunks/511-7fc07a209758eff2.js" defer=""></script><script src="./next/static/chunks/pages/revent-docs/backend-c7f8c0ffd9e56a21.js" defer=""></script><script src="./next/static/JdT8JfPCuYAw2lnSket1/buildManifest.js" defer=""></script><script src="./next/static/JdT8JfPCuYAw2lnSket1/ssgManifest.js" defer=""></script><script src="./next/static/JdT8JfPCuYAw2lnSket1/middlewareManifest.js" defer=""></script></head><body><div id="_next"><div class="nextra-container main-container flex flex-col"><nav class="flex items-center bg-white z-20 fixed top-0 left-0 right-0 h-16 border-b border-gray-200 px-6 dark:bg-dark dark:border-gray-900 bg-opacity-[.97] dark:bg-opacity-100"><div class="w-full flex items-center mr-2"><a class="no-underline text-current inline-flex items-center hover:opacity-75" href="/"><svg>...</svg><span>Revent Docs</span></a></div><div class="flex-1"><div class="hidden md:inline-block mr-2"><div class="nextra-search relative w-full md:w-64"><input class="appearance-none border rounded py-2 px-3 leading-tight focus:outline-none focus:ring w-full" type="search" placeholder="Search (&quot;/&quot; to focus)"/></div></div></div><a class="text-current p-2 cursor-pointer" tabindex="0"><svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none" shape-rendering="geometricPrecision"></svg></a><a class="text-current p-2" href="https://github.com/shuding/nextra" target="_blank"><svg height="24" viewBox="2 2 20 20" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3C7.0275 3 3 7.12937 3 12.2276C3 16.3109 5.57625 19.7597 9.15374 20.9824C9.60374 21.0631 9.77249 20.7863 9.77249 20.5441C9.77249 20.3249 9.76125 19.5982 9.76125 18.8254C7.5 19.2522 6.915 18.2602 6.735 17.7412C6.63375 17.4759 6.19499 16.6569 5.8125 16.4378C5.4975 16.2647 5.0475 15.838 5.80124 15.8264C6.51 15.8149 7.01625 16.4954 7.18499 16.7723C7.99499 18.1679 9.28875 17.7758 9.80625 17.5335C9.885 16.9337 10.1212 16.53 10.38 16.2993C8.3775 16.0687 6.285 15.2728 6.285 11.7432C6.285 10.7397 6.63375 9.9092 7.20749 9.26326C7.1175 9.03257 6.8025 8.08674 7.2975 6.81794C7.2975 6.81794 8.05125 6.57571 9.77249 7.76377C10.4925 7.55615 11.2575 7.45234 12.0225 7.45234C12.7875 7.45234 13.5525 7.55615 14.2725 7.76377C15.9937 6.56418 16.7475 6.81794 16.7475 6.81794C17.2424 8.08674 16.9275 9.03257 16.8375 9.26326C17.4113 9.9092 17.76 10.7281 17.76 11.7432C17.76 15.2843 15.6563 16.0687 13.6537 16.2993C13.98 16.5877 14.2613 17.1414 14.2613 18.0065C14.2613 19.2407 14.25 20.2326 14.25 20.5441C14.25 20.7863 14.4188 21.0746 14.8688 20.9824C16.6554 20.364 18.2079 19.1866 19.3078 17.6162C20.4077 16.0457 20.9995 14.1611 21 12.2276C21 7.12937 16.9725 3 12 3Z" fill="currentColor"></path></svg></a><button class="block md:hidden p-2"><svg fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button><div class="-mr-2"></div></nav><div class="flex flex-1 h-full"><aside class="fixed h-screen bg-white dark:bg-dark flex-shrink-0 w-full md:w-64 md:sticky z-20 hidden md:block" style="top:4rem;height:calc(100vh - 4rem)"><div class="sidebar border-gray-200 dark:border-gray-900 w-full p-4 pb-40 md:pb-16 h-full overflow-y-auto"><div class="mb-4 block md:hidden"><div class="nextra-search relative w-full md:w-64"><input class="appearance-none border rounded py-2 px-3 leading-tight focus:outline-none focus:ring w-full" type="search" placeholder="Search (&quot;/&quot; to focus)"/></div></div><div class="hidden md:block"><ul><li class=""><a href="/">Index</a></li><li class="active"><button>Revent-Docs</button><div style="display:initial"><ul><li class="active"><a href="/revent-docs/backend">Backend</a></li><li class=""><a href="/revent-docs/frontend">Frontend</a></li></ul></div></li></ul></div><div class="md:hidden"><ul><li class=""><a href="/">Index</a></li><li class="active"><button>Revent-Docs</button><div style="display:initial"><ul><li class="active"><a href="/revent-docs/backend">Backend</a></li><li class=""><a href="/revent-docs/frontend">Frontend</a></li></ul></div></li></ul></div></div></aside><div id="reach-skip-nav" data-reach-skip-nav-content=""></div><article class="docs-container relative pt-16 pb-16 px-6 md:px-8 w-full max-w-full flex min-w-0"><main class="max-w-screen-md mx-auto pt-4 z-10 min-w-0"><h1>Welcome to the revent-api creation!</h1>
<!-- --><p>This docs will help you start your own python project with pyenv, poetry, docker and deploying this to heroku just like we did the first time.</p>
<!-- --><p>Tools we are gonna use:</p>
<!-- --><ul>
<!-- --><li>
<!-- --><p><a href="https://github.com/pyenv/pyenv">Pyenv</a> - To manage and set your python version<!-- --></p>
<!-- --></li>
<!-- --><li>
<!-- --><p><a href="https://python-poetry.org/docs/#installation">Poetry</a> - To manage packages, dependency management<!-- --></p>
<!-- --></li>
<!-- --><li>
<!-- --><p><a href="https://direnv.net/docs/installation.html">Direnv</a> - To manage our virtual environment automatically<!-- --></p>
<!-- --></li>
<!-- --><li>
<!-- --><p><a href="https://docs.docker.com/get-docker/">Docker</a> - To create an image of your local setup and be able to run this anywhere<!-- --></p>
<!-- --></li>
<!-- --></ul>
<!-- --><p>In order to be more practical, the individual installation of each tool and integration with the environment will have to be done by you via the links above.</p>
<!-- --><p>Now that we have all the tools installed, let&#x27;s follow the steps:</p>
<!-- --><ol>
<!-- --><li>
<!-- --><p>Create your repository</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Clone the repository to your local workplace (we should have a .gitignore file and a README.md file)</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Install your python version using the terminal:</p>
<!-- --><pre><code class="language-bash">pyenv install &lt;version&gt;
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Move to the project folder and create your first file (that dictates which version of python to use) by running:</p>
<!-- --><pre><code class="language-bash">pyenv local &lt;version&gt;
</code></pre>
<!-- --><p>We have a new file now (.python-version) that will tell the version needed to run the app.</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Now we need to setup poetry so we can install packages, run:</p>
<!-- --><pre><code class="language-bash">poetry init
</code></pre>
<!-- --><p>We can just <!-- --><em>press Enter all the way</em> and configure things later.<!-- --><br/>
<!-- -->Now we have a new file(pyproject.toml) which will tell us what the app&#x27;s dependencies are (for now just python).<!-- --></p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Poetry also has a great feature, he creates a new virtual environment (if you don&#x27;t have one) that we are gonna ignore for now:<!-- --><br/>
<!-- -->Start by installing the current dependencies:<!-- --></p>
<!-- --><pre><code class="language-bash">poetry install
</code></pre>
<!-- --><p>Your current project now has a new file called poetry.lock with the installed dependencies and respective versions.</p>
<!-- --><p>But we don&#x27;t wanna have to activate this virtual environment everytime we come to work in the project, instead we are gonna use direnv!</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Since you already have direnv installed and hooked into your shell, start by creating a .envrc file with the following:</p>
<!-- --><pre><code class="language-bash">layout pyenv &lt;version&gt;
</code></pre>
<!-- --><p>Just change the &quot;version&quot; to your python version. Everytime you change .envrc file you will have to allow this change with <!-- --><strong><code>direnv allow</code></strong></p>
<!-- --><p>Through the terminal, leave the project folder and come back in to see your new virtual environment.</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>To set your interpreter to use this new path, run:</p>
<!-- --><pre><code class="language-bash">poetry env info --path
</code></pre>
<!-- --><p>Copy this path, add in the end of it /bin/python and if your are using vscode, go to settings and search for python interpreter.
Now select to use a specific path and use the one you just copy. Press Enter and you&#x27;r done! Now vscode will use this one.</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Add .envrc and .direnv to your .gitignore file</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Install the packages:</p>
<!-- --><pre><code class="language-bash">poetry add Django
</code></pre>
<!-- --><pre><code class="language-bash">poetry add strawberry-graphql
</code></pre>
<!-- --><pre><code class="language-bash">poetry add isort
</code></pre>
<!-- --><pre><code class="language-bash">poetry add gunicorn
</code></pre>
<!-- --><pre><code class="language-bash">poetry add django-environ
</code></pre>
<!-- --><p>And so on... notice that the last package we installed is one that will allow us to use .env files to hide our secrets!</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Create the django app:</p>
<!-- --><pre><code class="language-bash">django-admin startproject &lt;name_of_project&gt; .
</code></pre>
<!-- --><p>You shuld now have a folder with the name you choosed and a manage.py at the same level of other configuration files we created so far.</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Create your .env file and place your SECRET_KEY from project settings in there using <!-- --><a href="https://django-environ.readthedocs.io/en/latest/">django-environ</a></p>
<!-- --><ul>
<!-- --><li>
<!-- --><p>On settings.py:</p>
<!-- --><pre><code class="language-python">import environ
import os
env = environ.Env()
BASE_DIR = Path(__file__).resolve().parent.parent
environ.Env.read_env(os.path.join(BASE_DIR, &#x27;.env&#x27;))
SECRET_KEY = env(&#x27;SECRET_KEY&#x27;)
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>On your .env file you just save the same value you had on settings:</p>
<!-- --><ul>
<!-- --><li>
<!-- --><p>Example:</p>
<!-- --><pre><code class="language-python">SECRET_KEY=&#x27;django-insecure-+*(rklewjnr(klwnr0a70=ju^z)6$nujmo213po12341&#x27;
</code></pre>
<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p>add .env to your .gitignore file</p>
<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p>Start your django app</p>
<!-- --><pre><code class="language-bash">python manage.py startapp &lt;name_of_app&gt;
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Create a view on your app that looks like this:</p>
<!-- --><ul>
<!-- --><li>
<!-- --><p>The import:</p>
<!-- --><pre><code class="language-python">from django.http import HttpResponse
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>The method:</p>
<!-- --><pre><code class="language-python">def hello(request):
  return HttpResponse(&quot;Hello Runtime&quot;)
</code></pre>
<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p>On your project folder, go to urls.py and add this:</p>
<!-- --><ul>
<!-- --><li>
<!-- --><p>Import:</p>
<!-- --><pre><code class="language-python">from &lt;appname&gt; import views
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>On urlpatterns add: <!-- --><code>path(&#x27;&#x27;, views.hello, name=&#x27;hello&#x27;)</code></p>
<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p>Now we can run the app and see a &quot;Hello Runtime&quot; already!</p>
<!-- --><ul>
<!-- --><li>
<!-- --><p>On settings.py add <!-- --><code>&#x27;*&#x27;</code> to your allowed hosts.<!-- --></p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Run:</p>
<!-- --><pre><code class="language-bash">python manage.py runserver
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Go to your browser and check the link provided by the command above.</p>
<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p>Create a file called Makefile and add this command plus future commands there. Check example <!-- --><a href="https://makefiletutorial.com/">here</a>.<!-- --></p>
<!-- --></li>
<!-- --><li>
<!-- --><p>To build a docker image of your current project, start by creating a file called &#x27;Dockerfile&#x27; and one &#x27;.dockerignore&#x27;</p>
<!-- --><ul>
<!-- --><li>
<!-- --><p>For Dockerfile we are using this configuration:</p>
<!-- --><pre><code class="language-Dockerfile"># syntax=docker/dockerfile:1
FROM python:3

ARG DJANGO_ENV

ENV DJANGO_ENV=${DJANGO_ENV} \
  # python:
  PYTHONFAULTHANDLER=1 \
  PYTHONUNBUFFERED=1 \
  PYTHONHASHSEED=random \
  # pip:
  PIP_NO_CACHE_DIR=off \
  PIP_DISABLE_PIP_VERSION_CHECK=on \
  PIP_DEFAULT_TIMEOUT=100 \
  # poetry:
  POETRY_VERSION=1.1.13 \
  POETRY_VIRTUALENVS_CREATE=false \
  POETRY_CACHE_DIR=&#x27;/var/cache/pypoetry&#x27;

# System deps:
RUN apt-get update \
  &amp;&amp; apt-get install --no-install-recommends -y \
    bash \
    build-essential \
    curl \
    gettext \
    git \
    libpq-dev \
    wget \
  # Cleaning cache:
  &amp;&amp; apt-get autoremove -y &amp;&amp; apt-get clean -y &amp;&amp; rm -rf /var/lib/apt/lists/* \
  &amp;&amp; pip install &quot;poetry==$POETRY_VERSION&quot; &amp;&amp; poetry --version

# set work directory
WORKDIR /code

# Copy only requirements to cache them in docker layer
COPY poetry.lock pyproject.toml /code/

# Install dependencies:
RUN poetry install

# Creating folders, and files for a project:
COPY . /code

# run gunicorn
CMD gunicorn &lt;project_name&gt;.wsgi:application --bind 0.0.0.0:8000
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>For our .dockerignore file we use this one:</p>
<!-- --><pre><code class="language-.dockerignore">*.md
.direnv
.envrc
.gitignore

db.sqlite3
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Just for us to see something on the browser we will also create a file called docker-compose.yml with the following:</p>
<!-- --><pre><code class="language-docker-compose">version: &#x27;3.9&#x27;

services:
  web:
    build: .
    command: python manage.py runserver 0.0.0.0:8000
    ports:
      - 8000:8000
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Build the image running the docker build command:</p>
<!-- --><pre><code class="language-bash">docker build -t project:latest .
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Once this finishes run the docker-compose to open your web service:</p>
<!-- --><pre><code class="language-bash">docker-compose up
</code></pre>
<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p>Now that u seen your application running through docker let&#x27;s deploy our app to heroku. Start by:</p>
<!-- --><ol>
<!-- --><li>
<!-- --><p>Comment out docker-compose file and prepare our deploy for heroku creating a file heroku.yml with:</p>
<!-- --><pre><code class="language-heroku.yml">build:
  docker:
    web: Dockerfile
run:
  web: gunicorn &lt;project_name&gt;.wsgi:application --bind 0.0.0.0:$PORT
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Change the gunicorn command on dockerfile to this:</p>
<!-- --><pre><code class="language-dockerfile">CMD gunicorn &lt;project_name&gt;.wsgi:application --bind 0.0.0.0:$PORT
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Add .env to .dockerignore because we can&#x27;t send this environment variables to remote.</p>
<!-- --></li>
<!-- --><li>
<!-- --><p>On settings.py change DEBUG to False.</p>
<!-- --></li>
<!-- --></ol>
<!-- --></li>
<!-- --><li>
<!-- --><p>Everything is ready, create an account on heroku and install <!-- --><a href="https://devcenter.heroku.com/articles/heroku-cli">Heroku-CLI</a>.<!-- --></p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Now that we got Heroku installed, follow the next commands:</p>
<!-- --><ol>
<!-- --><li>
<!-- --><p>heroku login into your account</p>
<!-- --><pre><code class="language-bash">heroku login
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>heroku create app (you will get a random name like limitless-atoll-51647)</p>
<!-- --><pre><code class="language-bash">heroku create
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Add the SECRET_KEY environment variable to your app:</p>
<!-- --><pre><code class="language-bash">heroku config:set SECRET_KEY=SOME_SECRET_VALUE -a &lt;randomAppName&gt;
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>In your settings.py change the allowed hosts from <!-- --><code>&#x27;*&#x27;</code> to:<!-- --></p>
<!-- --><p><code>&#x27;localhost&#x27;, &#x27;127.0.0.1&#x27;, &#x27;&lt;randomAppName&gt;.herokuapp.com&#x27;</code></p>
<!-- --></li>
<!-- --><li>
<!-- --><p>Set your app to be a cointainer:</p>
<!-- --><pre><code class="language-bash">heroku stack:set container -a &lt;randomAppName&gt;
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Make your current git branch link to remote heroku</p>
<!-- --><pre><code class="language-bash">heroku git:remote -a &lt;randomAppName&gt;
</code></pre>
<!-- --></li>
<!-- --><li>
<!-- --><p>Just push it! Note: You have to make your commit first if u havent done so.</p>
<!-- --><pre><code class="language-bash">git add .
</code></pre>
<!-- --><pre><code class="language-bash">git commit -am &quot;Our first deploy&quot;
</code></pre>
<!-- --><pre><code class="language-bash">git push heroku &lt;ourBranchName&gt;:main
</code></pre>
<!-- --></li>
<!-- --></ol>
<!-- --></li>
<!-- --><li>
<!-- --><p>Alright now you have your project setup done, we did build an image for docker and deploy on heroku! Go start coding and have fun :)</p>
<!-- --></li>
<!-- --></ol><footer class="mt-24"><div class="flex flex-row items-center justify-between"><div><a class="text-lg font-medium p-4 -m-4 no-underline text-gray-600 hover:text-blue-600 flex items-center mr-2" title="Index" href="/"><svg height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="transform inline flex-shrink-0 rotate-180 mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Index<!-- --></a></div><div><a class="text-lg font-medium p-4 -m-4 no-underline text-gray-600 hover:text-blue-600 flex items-center ml-2" title="Frontend" href="/revent-docs/frontend">Frontend<!-- --><svg height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="transform inline flex-shrink-0 ml-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></a></div></div><hr/><div class="mt-24 flex justify-between flex-col-reverse md:flex-row items-center md:items-end"><span class="text-gray-600">Runtime Revolution Photo Contest 2022</span><div class="mt-6"></div><a class="text-sm" href="https://github.com/runtimerevolution/revent-docs/blob/main/pages/revent-docs/backend.mdx" target="_blank">Edit this page</a></div></footer></main><div class="w-64 hidden xl:block text-sm pl-4"></div></article></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/revent-docs/backend","query":{},"buildId":"JdT8JfPCuYAw2lnSket1","assetPrefix":".","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>